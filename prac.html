<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GreenFin AI Chatbot</title>
<style>
  body { margin:0; font-family:Arial,sans-serif; background:#f4f7f6; display:flex; flex-direction:column; height:100vh; }
  header { background: linear-gradient(90deg, #00C853, #2196F3); color:white; padding:15px 20px; font-size:1.2rem; font-weight:bold; display:flex; align-items:center; gap:10px; animation: navbarGlow 4s infinite alternate; }
  .logo-wrapper { width:55px; height:55px; border-radius:50%; background:white; display:flex; align-items:center; justify-content:center; overflow:hidden; box-shadow:0 0 10px rgba(0,0,0,0.2); }
  .logo-wrapper img { width:95%; animation: leafWave 2s ease-in-out infinite alternate; }
  @keyframes leafWave { 0%{transform:rotate(0deg) scale(1);} 50%{transform:rotate(-5deg) scale(1.05);} 100%{transform:rotate(5deg) scale(1);} }
  @keyframes navbarGlow { 0%{box-shadow:0 0 5px #00C853;} 100%{box-shadow:0 0 20px #2196F3;} }

  .chat-container { flex:1; overflow-y:auto; padding:20px; display:flex; flex-direction:column; }
  .message { max-width:70%; padding:12px 16px; margin:8px 0; border-radius:12px; font-size:0.95rem; line-height:1.4; }
  .user { align-self:flex-end; background:#2196F3; color:white; border-bottom-right-radius:0; }
  .bot { align-self:flex-start; background:#e6f5ea; color:#333; border-bottom-left-radius:0; }
  .typing { display:inline-block; }
  .dot { height:8px; width:8px; margin:0 2px; background-color:#333; border-radius:50%; display:inline-block; animation:blink 1.4s infinite both; }
  .dot:nth-child(2){animation-delay:0.2s;} .dot:nth-child(3){animation-delay:0.4s;}
  @keyframes blink { 0%{opacity:.2;} 20%{opacity:1;} 100%{opacity:.2;} }

  .input-container { display:flex; padding:12px; background:#fff; border-top:1px solid #ddd; }
  .input-container input { flex:1; padding:10px; border:1px solid #ccc; border-radius:8px; outline:none; font-size:1rem; }
  .input-container button { margin-left:10px; padding:10px 16px; background:#00C853; color:white; border:none; border-radius:8px; cursor:pointer; font-size:1rem; transition: transform 0.2s ease, background 0.3s ease; }
  .input-container button:hover { background:#00a244; transform:scale(1.05); }
  .input-container button:active { transform:scale(0.95); }

  .back-button { margin-left:auto; padding:8px 15px; background:white; color:#00C853; border-radius:8px; font-weight:bold; cursor:pointer; transition: transform 0.2s; }
  .back-button:hover { transform:scale(1.05); }
</style>
</head>
<body>

<header>
  <div class="logo-wrapper">
    <img src="GreenFinAI.png" alt="GreenFin AI Logo" />
  </div>
  GreenFin AI Chatbot
  <button class="back-button" onclick="window.location.href='index.html'">â¬… Back</button>
</header>

<div class="chat-container" id="chat-container">
  <div class="message bot">Hello ðŸ‘‹ Iâ€™m GreenFin AI, your sustainable finance assistant. How can I help you today?</div>
</div>

<div class="input-container">
  <input type="text" id="user-input" placeholder="Ask me about sustainable finance..." />
  <button onclick="sendMessage()">Send</button>
</div>

<script>
const chatContainer = document.getElementById("chat-container");
const userInput = document.getElementById("user-input");

async function sendMessage() {
  const text = userInput.value.trim();
  if (!text) return;

  // Add user message
  const userMsg = document.createElement("div");
  userMsg.className = "message user";
  userMsg.textContent = text;
  chatContainer.appendChild(userMsg);
  chatContainer.scrollTop = chatContainer.scrollHeight;
  userInput.value = "";

  // Typing indicator
  const typingMsg = document.createElement("div");
  typingMsg.className = "message bot";
  typingMsg.innerHTML = `<span class="typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>`;
  chatContainer.appendChild(typingMsg);
  chatContainer.scrollTop = chatContainer.scrollHeight;

  try {
    const response = await fetch("/api/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: text }),
    });
    const data = await response.json();

    typingMsg.remove();

    const botMsg = document.createElement("div");
    botMsg.className = "message bot";
    botMsg.textContent = data.response || "Sorry, I couldn't find an answer.";
    chatContainer.appendChild(botMsg);
    chatContainer.scrollTop = chatContainer.scrollHeight;

  } catch (error) {
    console.error("Error:", error);
    typingMsg.remove();
    const botMsg = document.createElement("div");
    botMsg.className = "message bot";
    botMsg.textContent = "Oops! Something went wrong.";
    chatContainer.appendChild(botMsg);
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }
}
</script>

</body>
</html>
